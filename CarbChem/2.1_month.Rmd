---
title: "Carbon Chemistry analysis  MOntly plots"
author: "Ana Palacio-Castro"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    fig_height: 8
    fig_width: 8
    df_print: paged
    toc: yes
    toc_float: true
editor_options:
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, options(knitr.kable.NA = ''))
```

# Libraries and settings

```{r, include=FALSE}
# Libraries
    library(plyr)
    library(tidyverse)
    library(reshape2)
    library(lubridate)
    library(knitr)
    library(dplyr)
    library(broom)

#Plots
    library(ggpubr)
    library(ggthemes)
    library(gridExtra)
    library(ggExtra)
    
#Models     
    library(lmodel2)    
    library(lmerTest)
    library(emmeans)

# Interactive Maps
    library(leaflet)

# Plots
MyTheme<-theme_bw() +  
theme(legend.position="top",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, 
                                         color = "black"))
```

# 1. Import and format carbon chemistry data

```{r, include=FALSE}
# 1. Get data
FLK.data<-read.csv("FLK_results/FLK_filtered.csv", header = T)
FLK.data$Mission<-NULL
FLK.data$Location<-NULL
FLK.data$Sample_Depth_m<-NULL

FLK.data$TA_0<-NULL
FLK.data$DIC_0<-NULL
FLK.data$nTA<-NULL
FLK.data$nDIC<-NULL
FLK.data$Sample_frequency<-NULL
FLK.data$Survey_design <-NULL


# 2. Format variables
  # Date/times
    # Year
    FLK.data$Year<-as.numeric(FLK.data$Year)
    summary(FLK.data$Year)

    FLK.data$Month<-factor(FLK.data$Month, 
                          levels = c("Apr", "May","Jun",
                                    "Jul", "Aug", "Sep",
                                    "Oct","Nov","Dec",
                                    "Jan", "Feb", "Mar"))
    summary(FLK.data$Month)
    #FLK.data$Months<-months(FLK.data$ESTDate)
    FLK.data$Months<-factor(FLK.data$Months, levels = month.name)
    FLK.data$Date<-as.Date(FLK.data$Date)
    
  FLK.data$Sub_region<-factor(FLK.data$Sub_region, levels = c(
                          "BB", "UK", "MK", "LK"))
  
  FLK.data$Zone<-factor(FLK.data$Zone, levels = c(
                        "Inshore", "Mid channel", 
                        "Offshore", "Oceanic"))
  FLK.data$Reference<-factor(FLK.data$Reference, levels = c(
                        "BB_1", "BB_2", "UK_3", "UK_4", 
                        "MK_5", "MK_6", "MK_7",
                        "LK_8", "LK_9", "LK_10"))
      
  FLK.data$Season<-factor(FLK.data$Season, levels = c(
                        "Spring", "Summer", "Fall", "Winter"))

summary(FLK.data)

```

## Seasonality


* Spring: March 20-June 18
* Summer: June 19-Sep 20 
* Fall: Sep 21-Dec 19
* Winter: Dec 20-March 19

* Wet: May - October
* Dry: November - April


## Remove extreme events?

```{r}
# Label and filter extreme events
  FLK.data$Extreme<-as.factor(FLK.data$Extreme)
  summary(FLK.data$Extreme)
```

# 2. TA and DIC salinity normalization

## Salinity standardizations 

1. Used salinity Bottle first, if not available, salinity CTD

```{r}
#MeanSalinity<-mean(FLK.data[FLK.data$Zone=="Oceanic",]$BestSalinity)
MeanSalinity<-mean(FLK.data$BestSalinity)
```

```{r}
# TA_Sal<- ggplot(FLK.data) + MyTheme+
#   geom_point(aes (BestSalinity, TA_umol_kg, fill=Season), 
#              alpha=0.5, shape=21, size=1)+
#   geom_smooth(aes(BestSalinity, TA_umol_kg), 
#               linetype=2, method = "lm", color="black")
# 
# ggExtra::ggMarginal(
#   p = TA_Sal,
#   type = 'boxplot',
#   margins = 'both',
#   size = 5,
#   colour = 'black',
#   fill = 'gray'
# )
# 
# TA_Sal + facet_wrap(~Zone)
# TA_Sal+ facet_grid(Zone~Season)
# #TA_Sal+ facet_grid(Zone~Precipitation)
# 
# DIC_Sal<- ggplot(FLK.data) + MyTheme+
#   geom_point(aes (BestSalinity, DIC_umol_kg, fill=Season), 
#              alpha=0.5, shape=21, size=1)+
#   geom_smooth(aes(BestSalinity, DIC_umol_kg), 
#               linetype=2, method = "lm", color="black")
#   
# ggExtra::ggMarginal(
#   p = DIC_Sal,
#   type = 'boxplot',
#   margins = 'both',
#   size = 5,
#   colour = 'black',
#   fill = 'gray'
# )
# 
# DIC_Sal + facet_wrap(~Zone)
# DIC_Sal+ facet_grid(Zone~Season)
```

2. Calculate TA intercepts

```{r}
# TA_coef <- FLK.data %>% 
#                  group_by(Region) %>%
#                  do({model = lm(TA_umol_kg~BestSalinity, data=.)  # model
#                      data.frame(tidy(model), # get coefficient info
#                     glance(model))})        # get model info
TA_coef <- FLK.data[FLK.data$Zone=="Oceanic",] %>%
                group_by(Region) %>%
                do({model = lm(TA_umol_kg~BestSalinity, data=.)  # model
                    data.frame(tidy(model), # get coefficient info
                    glance(model))})        # get model info

# TA_coef <- FLK.data[FLK.data$Zone=="Oceanic",] %>%
#                 group_by(Region) %>%
#                 do({model = lmodel2(TA_umol_kg~BestSalinity, data=.)  # model
#                     data.frame(tidy(model), # get coefficient info
#                     glance(model))})        # get model info

TA_coe <- lmodel2(TA_umol_kg~BestSalinity,
                            data=FLK.data[FLK.data$Zone=="Oceanic",])

plot(TA_coe, "OLS")
plot(TA_coe, "MA")
plot(TA_coe, "SMA")

```

3. Calculate DIC intercepts 

```{r}
# 3.DIC normalization to intercept  

    # DIC_coef <- FLK.data %>%
    #               group_by(Region) %>%
    #               do({model = lm(DIC_umol_kg~BestSalinity, data=.)
    #               # create model
    #               data.frame(tidy(model), # get coefficient info
    #               glance(model))})        # get model info
    
    DIC_coef <- FLK.data[FLK.data$Zone=="Oceanic",] %>%
                  group_by(Region) %>%
                  do({model = lm(DIC_umol_kg~BestSalinity, data=.)
                  # create model
                  data.frame(tidy(model), # get coefficient info
                  glance(model))})        # get model info
```

4. Normalize with Friss equation

```{r}
# 4. Add endmember intercepts

  TA_TO<-subset(TA_coef, term=="(Intercept)")
  TA_TO<-as.data.frame(select(TA_TO, c(Region, estimate)))
  names(TA_TO)[2] <- "TA_0"
  
  DIC_TO<-subset(DIC_coef, term=="(Intercept)")
  DIC_TO<-as.data.frame(select(DIC_TO, c(Region, estimate)))
  names(DIC_TO)[2] <- "DIC_0"
    
  Intercepts<-join(TA_TO, DIC_TO, by="Region", type="full")
  FLK.data<-join(FLK.data, Intercepts, by="Region", type="left")
```

```{r}
  # 5. endmember and salinity (mean) normalization
  FLK.data$nTA<-((
    (FLK.data$TA_umol_kg-FLK.data$TA_0)/
    FLK.data$BestSalinity)*MeanSalinity)+FLK.data$TA_0
  
  FLK.data$nDIC<-((
    (FLK.data$DIC_umol_kg-FLK.data$DIC_0)/
    FLK.data$BestSalinity)*MeanSalinity)+FLK.data$DIC_0
  
  # 2. TA and DIC 35 normalization
    FLK.data$n35TA<-(FLK.data$TA_umol_kg/FLK.data$BestSalinity)*MeanSalinity
    FLK.data$n35DIC<-(FLK.data$DIC_umol_kg/FLK.data$BestSalinity)*MeanSalinity
    # FLK.data$n35TA<-(FLK.data$TA_umol_kg/FLK.data$BestSalinity)*35
    # FLK.data$n35DIC<-(FLK.data$DIC_umol_kg/FLK.data$BestSalinity)*35
  
#write.csv(FLK.data, "FLK_results/FLK.data_filtered_normalized.csv", row.names = F)
```

5. TA parameters to nTA

```{r}
kable(as.data.frame(TA_coef[,1:8], format = "markdown"), 
      caption = "Table 1: TA parameters for saliniy normalization with endmember S0",
      digits = 2)
#write.csv(TA_coef, "TA_coef.csv")

```
    
```{r, echo=F, fig.height=8.8, fig.width=8.8}
# 5. Chech normalization?
nTA_Sal<- ggplot(FLK.data) + MyTheme+
  
  geom_point(aes (BestSalinity, TA_umol_kg, fill=Extreme),
             alpha=0.5, shape=21, size=1)+
  geom_smooth(aes(BestSalinity, TA_umol_kg),
              linetype=2, method = "lm", color="black")+
    
  geom_point(aes (BestSalinity, nTA, fill=Extreme),
             alpha=0.5, shape=24, size=1)+
  geom_smooth(aes(BestSalinity, nTA),
              linetype=1, method = "lm")+  
    
  geom_point(aes (BestSalinity, n35TA, fill=Extreme),
             alpha=0.5, shape=25, size=1)+
  geom_smooth(aes(BestSalinity, n35TA), 
              linetype=1, method = "lm",  color="red")  
```

6. DIC parameters to nDIC

```{r}
kable(as.data.frame(DIC_coef[,1:8], format = "markdown"), 
      caption = "Table 2: DIC parameters for saliniy normalization with endmember S0",
      digits = 2)

#write.csv(DIC_coef, "DIC_coef.csv")
    
```

```{r, echo=F, fig.height=8.8, fig.width=8.8}
nDIC_Sal<- ggplot(FLK.data) + MyTheme+
  
  geom_point(aes (BestSalinity, DIC_umol_kg, fill=Extreme),
             alpha=0.5, shape=21, size=1)+
  geom_smooth(aes(BestSalinity, DIC_umol_kg),
              linetype=2, method = "lm", color="black")+
    
  geom_point(aes (BestSalinity, nDIC, fill=Extreme),
             alpha=0.5, shape=24, size=1)+
  geom_smooth(aes(BestSalinity, nDIC),
              linetype=1, method = "lm")+  
    
  geom_point(aes (BestSalinity, n35DIC,
                  fill=Extreme), alpha=0.5, shape=25, size=1)+
  geom_smooth(aes(BestSalinity, n35DIC),
              linetype=1, method = "lm",  color="red")
```

```{r,  echo=FALSE}
FLK_parameters<-ggarrange(nTA_Sal, nDIC_Sal,
          #labels = c("DIC Friss regresion", "TA Friss regresion"),
          ncol = 2, nrow = 1)
FLK_parameters
```

**Figure Supp 1:** Overview of linear regressions of total alkalinity (TA, µmol kg−1) and dissolved inorganic carbon (DIC, µmol kg−1) as a function of salinity + Friss normalized values.

* Original data: Black line and circles
* Friis normalization S0 endmember: blue line and pointing up triangles
* Mean salinity normalization: red line and pointing down triangles

```{r}
nTA_TA<- ggplot(FLK.data, aes (TA_umol_kg, nTA)) + 
  
  scale_y_continuous(#limits = c(1700,2900),
                     #expand = c(0, 0),
                     #breaks = seq(1800, 2800, 100),
                    name="nTA") +
  scale_x_continuous(# limits = c(1600, 2600),
                     # expand = c(0, 0),
                     # breaks = seq(1500,2600,100),
                      name="TA")+
  geom_smooth(method = "lm", colour="black")+
  MyTheme

nTA_TA_ext<-nTA_TA +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Extreme, shape=Zone), alpha=0.4)
#nTA_TA_ext

nTA_TA_pre<-nTA_TA +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Precipitation, shape=Zone), alpha=0.4)
#nTA_TA_pre

nTA_TA_plots<-ggarrange(nTA_TA_ext, nTA_TA_pre,
          #labels = c("", ""),
          ncol = 2, nrow = 1)
nTA_TA_plots
```

```{r}
nDIC_DIC<- ggplot(FLK.data, aes (DIC_umol_kg, nDIC)) + 
  
  scale_y_continuous(#limits = c(1700,2900),
                     #expand = c(0, 0),
                     #breaks = seq(1800, 2800, 100),
                    name="nDIC") +
  scale_x_continuous(# limits = c(1600, 2600),
                     # expand = c(0, 0),
                     # breaks = seq(1500,2600,100),
                      name="DIC")+
  geom_smooth(method = "lm", colour="black")+
  MyTheme

nDIC_DIC_ext<-nDIC_DIC +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Extreme, shape=Zone), alpha=0.4)
#nDIC_DIC_ext

nDIC_DIC_pre<-nDIC_DIC +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Precipitation, shape=Zone), alpha=0.4)
#nDIC_DIC_pre

nDIC_DIC_plots<-ggarrange(nDIC_DIC_ext, nDIC_DIC_pre,
          #labels = c("", ""),
          ncol = 2, nrow = 1)
nDIC_DIC_plots
```


```{r}
n35TA_TA<- ggplot(FLK.data, aes (TA_umol_kg, n35TA)) + 
  
  scale_y_continuous(#limits = c(1700,2900),
                    name="n35TA") +
  scale_x_continuous(# limits = c(1600, 2600),
                     name="TA")+
  geom_smooth(method = "lm", colour="black")+
  MyTheme

n35TA_TA_ext<-n35TA_TA +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Extreme, shape=Zone), alpha=0.4)
#n35TA_TA_ext

n35TA_TA_pre<-n35TA_TA +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Precipitation, shape=Zone), alpha=0.4)
#n35TA_TA_pre

n35TA_TA_plots<-ggarrange(n35TA_TA_ext, n35TA_TA_pre,
          #labels = c("", ""),
          ncol = 2, nrow = 1)
n35TA_TA_plots
```

```{r}
TAdiff<- ggplot(FLK.data, aes (BestSalinity, TA_umol_kg-n35TA)) + 
  
  scale_y_continuous(#limits = c(1700,2900),
                    name="TA - nTA") +
  scale_x_continuous(# limits = c(1600, 2600),
                     name="Salinity")+
  geom_smooth(method = "lm", colour="black")+
  MyTheme

TAdiff_pre<-TAdiff +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Precipitation, shape=Zone), alpha=0.4)
ggExtra::ggMarginal(
  p = TAdiff_pre,
  type = 'boxplot',
  margins = 'both',
  size = 5,
  colour = 'black',
  fill = 'gray'
)
```


```{r}
n35DIC_DIC<- ggplot(FLK.data, aes (DIC_umol_kg, n35DIC)) + 
  
  scale_y_continuous(#limits = c(1700,2900),
                     name="n35DIC") +
  scale_x_continuous(# limits = c(1600, 2600),
                     name="DIC")+
  geom_smooth(method = "lm", colour="black")+
  MyTheme

n35DIC_DIC_ext<-n35DIC_DIC +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Extreme, shape=Zone), alpha=0.4)
#n35DIC_DIC_ext

n35DIC_DIC_pre<-n35DIC_DIC +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Precipitation, shape=Zone), alpha=0.4)
#n35DIC_DIC_pre

nDIC_DIC_plots<-ggarrange(n35DIC_DIC_ext, n35DIC_DIC_pre,
          #labels = c("", ""),
          ncol = 2, nrow = 1)
nDIC_DIC_plots
```


```{r}
DICdiff<- ggplot(FLK.data, aes (BestSalinity, DIC_umol_kg-n35DIC)) + 
  
  scale_y_continuous(#limits = c(1700,2900),
                    name="DIC - n35DIC") +
  scale_x_continuous(# limits = c(1600, 2600),
                     name="Salinity")+
  geom_smooth(method = "lm", colour="black")+
  MyTheme

DICdiff_pre<-DICdiff +
  scale_shape_manual(values=c(21,21,24, 24))+
  geom_point(aes (fill=Precipitation, shape=Zone), alpha=0.4)
ggExtra::ggMarginal(
  p = DICdiff_pre,
  type = 'boxplot',
  margins = 'both',
  size = 5,
  colour = 'black',
  fill = 'gray'
)

```


## Data for endmember comparissions

```{r}
# Endmember coparissons
  FLK.data_filtered<-FLK.data[FLK.data$Extreme=="Normal",]

  # Reef
  WS.reef<-subset(FLK.data, FLK.data$Zone!="Oceanic")
  WS.reef$Date<-as.Date(WS.reef$Date, "%Y-%m-%d")
  # WS.reef<-subset(FLK.data, 
  #                 FLK.data$Zone=="Mid channel"|
  #                 FLK.data$Zone=="Inshore")
  # WS.reef$Date<-as.Date(WS.reef$Date, "%Y-%m-%d")
  #summary(WS.reef)
  
  # Open
  # WS.open<-subset(FLK.data,
  #                 FLK.data$Zone=="Offshore"|
  #                 FLK.data$Zone=="Oceanic")
  # WS.open$Date<-as.Date(WS.open$Date, "%Y-%m-%d")
  WS.open<-subset(FLK.data,
                  FLK.data$Zone=="Oceanic")
  WS.open$Date<-as.Date(WS.open$Date, "%Y-%m-%d")
  #summary(WS.open)

  mean_Open<- ddply (WS.open, .(MY, Month),
                            summarise,
                  OnTA_my = mean (n35TA, na.rm = T),
                  OnDIC_my = mean (n35DIC, na.rm = T),
                  OTA_my = mean (TA_umol_kg, na.rm = T),
                  ODIC_my = mean (DIC_umol_kg, na.rm = T),
                  OpCO2_O = mean (pCO2_uatm , na.rm = T),
                  OpH_O = mean (pH_calculated, na.rm = T),
                  OAra_O = mean (Aragonite_Sat_W , na.rm = T)
                  )
  mean_Op<- ddply (WS.open, .(Region),
                            summarise,
                  OTem = mean (Temperature_C, na.rm = T), 
                  OSal = mean (BestSalinity, na.rm = T), 
                  OnTA = mean (n35TA, na.rm = T),
                  OnDIC = mean (n35DIC, na.rm = T),
                  OTA = mean (TA_umol_kg, na.rm = T),
                  ODIC = mean (DIC_umol_kg, na.rm = T),
                  OpCO2 = mean (pCO2_uatm , na.rm = T),
                  OpH = mean (pH_calculated, na.rm = T),
                  OAra = mean (Aragonite_Sat_W , na.rm = T)
                  )
  
```

# 3. TA and DIC relation

```{r}
TA_DIC<- ggplot(FLK.data, aes (DIC_umol_kg, TA_umol_kg)) +

  scale_y_continuous(#limits = c(1700,2900),
                     #expand = c(0, 0),
                     #breaks = seq(1800, 2800, 100),
                     expression(paste("TA (", mu, "mol ", kg^-1, ")")))+
  scale_x_continuous(# limits = c(1600, 2600),
                     # expand = c(0, 0),
                     # breaks = seq(1500,2600,100),
                     expression(paste("DIC (", mu, "mol ", kg^-1, ")")))+
  facet_grid(Zone~Sub_region)+ MyTheme

```

<!-- ## 3.1 All FLK samples) -->

```{r, fig.height=8.8, fig.width=8.8}
# TA_DIC_ext<-TA_DIC +
#    scale_shape_manual(values=c(21,21,24, 24))+
#   geom_point(aes (fill=Extreme, shape=Zone), alpha=0.4)+
#   geom_smooth(method = "lm", colour="black")
# TA_DIC_ext

```

```{r, fig.height=8.8, fig.width=8.8}
# TA_DIC_pre<-TA_DIC +
#   scale_shape_manual(values=c(21,21,24, 24))+
#   geom_point(aes (fill=Precipitation,  shape=Zone), alpha=0.4)+
#   geom_smooth(method = "lm", colour="black")
# TA_DIC_pre
```

```{r}
 # Individual LR for each Zone and Sub_region
  # TA_DIC_coef_zone <- FLK.data %>% 
  #                   group_by(Zone, Sub_region) %>%
  #                   do({model = lm(TA_umol_kg ~ DIC_umol_kg, data=.)  
  #                   # create model
  #                   data.frame(tidy(model), # get coefficient info
  #                   glance(model))})        # get model info
  # 
  #   kable(as.data.frame(TA_DIC_coef_zone[,1:8], format = "markdown"),
  #         caption = "TA vs DIC equations with all data", digits = 3)
```

<!-- ## 3.2 All normalized (all FLK samples) -->

```{r}
nTA_nDIC<- ggplot(FLK.data, aes (n35DIC, n35TA)) +
  scale_y_continuous(#limits = c(1700,2900),
                     #expand = c(0, 0),
                     #breaks = seq(1800, 2800, 100),
                    name="Salinity-nTA") +
  scale_x_continuous(# limits = c(1600, 2600),
                     # expand = c(0, 0),
                     # breaks = seq(1500,2600,100),
                      name="Salinity-nDIC")+
  facet_grid(Zone~Sub_region) + MyTheme

```

```{r, fig.height=8, fig.width=8}
# nTA_nDIC_ext<-nTA_nDIC +
#    scale_shape_manual(values=c(21,21,24, 24))+
#   geom_point(aes (fill=Extreme, shape=Zone), alpha=0.4)+
#   geom_smooth(method = "lm", colour="black")
 
```

```{r, fig.height=8.8, fig.width=8.8}
# nTA_nDIC_pre<-nTA_nDIC +
#   scale_shape_manual(values=c(21,21,24, 24))+
#   geom_point(aes (fill=Precipitation,  shape=Zone), alpha=0.4)+
#   geom_smooth(method = "lm", colour="black")
# nTA_nDIC_pre
 
```

```{r}
 # Individual LR for each Zone and Sub_region
    # TA_DIC_coef_zone <- FLK.data %>% 
    #                 group_by(Zone, Sub_region) %>%
    #                 do({model = lm(nTA~nDIC, data=.)  
    #                 # create model
    #                 data.frame(tidy(model), # get coefficient info
    #                 glance(model))})        # get model info
    # 
    # kable(as.data.frame(TA_DIC_coef_zone[,1:8], format = "markdown"),
    #       caption = "nTA vs nDIC equations", digits = 3)
```

## 3.3 Removing extreme events

```{r, fig.height=8.8, fig.width=8.8}
# TA_DIC_Extreme_ex <-TA_DIC+ 
#   geom_point(data=FLK.data, aes (DIC_umol_kg, TA_umol_kg, fill=Extreme), 
#              shape=21, alpha=0.8, size=1)+
#   geom_smooth(data=FLK.data[FLK.data$Extreme=="Normal", ], 
#               aes (DIC_umol_kg, TA_umol_kg), method = "lm", colour="black")
# TA_DIC_Extreme_ex

```

```{r}
TA_DIC_Zone <- ddply (FLK.data[FLK.data$Extreme=="Normal", ], .(Zone),summarise,
                TAmean = mean (TA_umol_kg, na.rm = T), 
                DICmean = mean (DIC_umol_kg, na.rm = T),
                nTAmean = mean (n35TA, na.rm = T), 
                nDICmean = mean (n35DIC, na.rm = T))

TA_DIC_Ocean<-TA_DIC_Zone[TA_DIC_Zone$Zone=="Oceanic", ]

kable(as.data.frame(TA_DIC_Zone, format = "markdown"), caption = "mean TA/DIC by zone")
```

```{r}
TA_DIC_Extreme_pre<-TA_DIC + 
  geom_abline(intercept = -1700, slope=2, color="grey")+
  geom_hline (yintercept = TA_DIC_Ocean$TAmean, color="grey")+
  scale_shape_manual(values=c(24, 25, 21))+
  geom_point(data=FLK.data, aes (DIC_umol_kg, TA_umol_kg,
                                 fill=Precipitation, shape=Extreme),
             alpha=0.8, size=1)+
    geom_smooth(data=FLK.data[FLK.data$Extreme=="Normal", ], 
              aes(DIC_umol_kg, TA_umol_kg), method = "lm", colour="black")+
  
    # geom_abline(slope = 0, intercept =TA_DIC_Ocean$TAmean, 
    #           linetype=2, colour="gray")+
    # geom_vline(xintercept = TA_DIC_Ocean$DICmean,
    #          linetype=2, colour="gray")+
    geom_point(aes(x=TA_DIC_Ocean$DICmean, y=TA_DIC_Ocean$TAmean),
             size=3, alpha=1, shape=21, fill="black")
TA_DIC_Extreme_pre

```

**Figure 2a:** Linear regressions of total alkalinity (TA; µmol kg−1) and dissolved inorganic carbon (DIC; µmol kg−1)


```{r}
# Individual LR for each Zone and Sub_region
    
TA_DIC_coef_zone_noExtremes <- FLK.data[FLK.data$Extreme=="Normal", ] %>% 
                    group_by(Zone, Sub_region) %>%
                    do({model = lm(TA_umol_kg~DIC_umol_kg, data=.)  
                    # create model
                    data.frame(tidy(model), # get coefficient info
                    glance(model))})        # get model info

kable(as.data.frame(TA_DIC_coef_zone_noExtremes[,1:8], 
      format = "markdown"),
      caption = "TA vs DIC equations without extreme events",
      digits = 2)

#write.csv(TA_DIC_coef_zone_noExtremes, "FLK_results/Fig_2_TA_DIC_coef_slopes_Subregion.csv", row.names = FALSE)
    
```

## 3.4 Removing extreme events normalized

```{r}
nTA_nDIC_Extreme_pre<-nTA_nDIC +
  geom_abline(intercept = -1700, slope=2, color="grey")+
  geom_hline (yintercept = 2381.6, color="grey")+
  scale_shape_manual(values=c(24, 25, 21))+
  geom_point(data=FLK.data, aes (n35DIC, n35TA,
                                 fill=Precipitation, shape=Extreme),
             alpha=0.8, size=1)+
    geom_smooth(data=FLK.data[FLK.data$Extreme=="Normal", ],
              aes(n35DIC, n35TA), method = "lm", colour="black")+

    # geom_abline(slope = 0, intercept =TA_DIC_Ocean$nTAmean,
    #           linetype=2, colour="gray")+
    # geom_vline(xintercept = TA_DIC_Ocean$nDICmean,
    #          linetype=2, colour="gray")+
    geom_point(aes(x=TA_DIC_Ocean$nDICmean, y=TA_DIC_Ocean$nTAmean),
             size=3, alpha=1, shape=21, fill="black")
nTA_nDIC_Extreme_pre

```

<!-- **Figure 2a:** Linear regressions of total alkalinity (nTA; µmol kg−1) and dissolved inorganic carbon (nDIC; µmol kg−1) -->

```{r}
# Individual LR for each Zone and Sub_region
    
nTA_nDIC_coef_zone_noExtremes <- FLK.data[FLK.data$Extreme=="Normal", ] %>%
                    group_by(Zone, Sub_region) %>%
                    do({model = lm(n35TA~n35DIC, data=.)
                    # create model
                    data.frame(tidy(model), # get coefficient info
                    glance(model))})        # get model info

kable(as.data.frame(nTA_nDIC_coef_zone_noExtremes[,1:8],
      format = "markdown"),
      caption = "nTA vs nDIC equations without extreme events",
      digits = 2)

#write.csv(TA_DIC_coef_zone_noExtremes, "FLK_results/Fig_2_TA_DIC_coef_slopes_Subregion.csv", row.names = FALSE)
    
```

## 3.5 By reef - Removing Extreme events

```{r, fig.height=8, fig.width=8.8}
TA_DIC_reef_pre<-TA_DIC_Extreme_pre + 
  facet_grid(Zone~Reference)
TA_DIC_reef_pre
```

**Figure Sup:** Linear regressions of total alkalinity (TA; µmol kg−1) and dissolved inorganic carbon (DIC; µmol kg−1) by reef and zone

```{r}
# Individual LR for each reef
TA_DIC_coef_Reef_noExtremes <- FLK.data[FLK.data$Extreme=="Normal", ] %>% 
                    group_by(Zone, Sub_region, Reference, Precipitation) %>%
                    do({model = lm(TA_umol_kg~DIC_umol_kg, data=.)  
                    # create model
                    data.frame(tidy(model), # get coefficient info
                    glance(model))})        # get model info

  kable(as.data.frame(TA_DIC_coef_Reef_noExtremes[,1:11],
                      format = "markdown"),
        caption = "TA vs DIC equations by reef without extreme events",
        digits = 2)
#write.csv (TA_DIC_coef_Reef_noExtremes, "FLK_results/Fig_2_TA_DIC_slopes_Reefs.csv", row.names = FALSE)
  
  TA_DIC_coef_Reef_noExtremes <- FLK.data[FLK.data$Extreme=="Normal", ] %>% 
                    group_by(Zone, Region, Sub_region, Transect, Precipitation) %>%
                    do({model = lm(TA_umol_kg~DIC_umol_kg, data=.)  
                    # create model
                    data.frame(tidy(model), # get coefficient info
                    glance(model))})        # get model info


```

```{r, fig.height=8, fig.width=4}
Slopes_reef<-subset(TA_DIC_coef_Reef_noExtremes, term!="(Intercept)")

Slope_plot<-ggplot(data=Slopes_reef, aes (x =Sub_region, y =estimate)) +
  MyTheme+
  scale_shape_manual(values=c(22, 23, 25))+
  geom_boxplot(aes())+
  geom_jitter(aes(fill = factor(Precipitation), shape = Transect), width = 0.25)+
  scale_y_continuous(#limits = c(1700,2900),
                     #expand = c(0, 0),
                     #breaks = seq(1800, 2800, 100),
                     expression(paste("TA vs DIC slope")))+
  facet_grid(Zone~Region)+
  theme(legend.title = element_blank())
Slope_plot

```

**Figure 2b:** TA (µmol kg−1) vs DIC (µmol kg−1) slopes

```{r,  echo=FALSE}
FLK_slopes<-ggarrange(TA_DIC_Extreme_pre, Slope_plot,
          #labels = c("DIC Friss regresion", "TA Friss regresion"),
          ncol = 2, nrow = 1, widths = c(4, 1.5))
FLK_slopes

#ggsave(file="FLK_results/Fig_2_FLK_slopes.svg", plot=FLK_slopes, dpi = 300, width=6, height=6.2)
  
```

**Figure 2:** TA (µmol kg−1) vs DIC (µmol kg−1) slopes per season and reef

## 3.6 By reef - Removing Extreme events-normalized

```{r, fig.height=8, fig.width=8.8}
nTA_nDIC_reef_pre<-nTA_nDIC_Extreme_pre +
  facet_grid(Zone~Reference)
nTA_nDIC_reef_pre
```

<!-- **Figure S:** Linear regressions of total alkalinity (nTA; µmol kg−1) and dissolved inorganic carbon (nDIC; µmol kg−1) by reef and zone -->

```{r}
# Individual LR for each reef
nTA_nDIC_coef_Reef_noExtremes <- FLK.data[FLK.data$Extreme=="Normal", ] %>%
                    group_by(Zone, Sub_region, Reference, Precipitation) %>%
                    do({model = lm(n35TA~n35DIC, data=.)
                    # create model
                    data.frame(tidy(model), # get coefficient info
                    glance(model))})        # get model info

  kable(as.data.frame(nTA_nDIC_coef_Reef_noExtremes[,1:11],
                      format = "markdown"),
        caption = "TA vs DIC equations by reef without extreme events",
        digits = 2)
#write.csv (nTA_nDIC_coef_Reef_noExtremes, "FLK_results/Fig_2_nTA_nDIC_slopes_Reefs.csv", row.names = FALSE)

  nTA_nDIC_coef_Reef_noExtremes <- FLK.data[FLK.data$Extreme=="Normal", ] %>%
                    group_by(Zone, Region, Sub_region, Transect, Precipitation) %>%
                    do({model = lm(n35TA~n35DIC, data=.)
                    # create model
                    data.frame(tidy(model), # get coefficient info
                    glance(model))})        # get model info


```

```{r, fig.height=8, fig.width=5}
nSlopes_reef<-subset(nTA_nDIC_coef_Reef_noExtremes, term!="(Intercept)")

nSlopes_reef<-ggplot(data=nSlopes_reef, aes (x =Sub_region, y =estimate)) +
  MyTheme+
  scale_shape_manual(values=c(22, 23, 25))+
  geom_boxplot(aes())+
  geom_jitter(aes(fill = factor(Precipitation), shape = Transect), width = 0.25)+
  scale_y_continuous(#limits = c(1700,2900),
                     #expand = c(0, 0),
                     #breaks = seq(1800, 2800, 100),
                     expression(paste("nTA vs nDIC slope")))+
  facet_grid(Zone~Region)+
  theme(legend.title = element_blank())
nSlopes_reef

```

**Figure 2b:** nTA (µmol kg−1) vs nDIC (µmol kg−1) slopes

```{r,  echo=FALSE}
FLK_nslopes<-ggarrange(nTA_nDIC_Extreme_pre, nSlopes_reef,
          #labels = c("DIC Friss regresion", "TA Friss regresion"),
          ncol = 2, nrow = 1, widths = c(4, 1.5))
FLK_nslopes

#ggsave(file="FLK_results/Fig_2_FLK_slopes.svg", plot=FLK_slopes, dpi = 300, width=6, height=6.2)
  
```

<!-- **Figure 2:** nTA (µmol kg−1) vs nDIC (µmol kg−1) slopes per season and reef -->

# 4 Monthly plots

```{r}
Month_ploth<- ggplot(FLK.data) +
        MyTheme +  
        facet_grid(Zone~Sub_region)+
        scale_shape_manual(values=c(24, 25, 21))+
        theme(axis.title.x = element_blank() )
```

## Temperature

```{r, echo=FALSE, fig.height=8, fig.width=8}
Temperature_month<- Month_ploth+
 
   scale_y_continuous(#limits = c(15,40),
                       name=(expression("Temperature"~(degree*C))),
                       breaks = seq(16, 40, 4),  
                       expand = c(0.05, 0.05)) +
 
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=Temperature_C))+
    
    geom_point(data=FLK.data, aes (x=Month, y=Temperature_C, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)+
    geom_abline(slope = 0, intercept = mean_Op$OTem, color="grey")
Temperature_month
```

## Salinity

```{r, echo=FALSE, fig.height=8, fig.width=8}
Sal_month<- Month_ploth+
 
   scale_y_continuous(#limits = c(15,40),
                       name=(expression("Salinity")),
                       breaks = seq(15, 40, 2),  
                       expand = c(0.05, 0.05)) +
  
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=BestSalinity))+
    
    geom_point(data=FLK.data, aes (x=Month, y=BestSalinity, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)+
    geom_abline(slope = 0, intercept = mean_Op$OSal, color="grey")
Sal_month
```

## TA

```{r, echo=FALSE, fig.height=8, fig.width=8}
TA_month<- Month_ploth+
 
   scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste("TA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=TA_umol_kg))+
    
    geom_point(data=FLK.data, aes (x=Month, y=TA_umol_kg, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)+
    geom_abline(slope = 0, intercept = mean_Op$OTA, color="grey")
TA_month
```

## nTA

```{r, echo=FALSE, fig.height=8, fig.width=8}
nTA_month<- Month_ploth+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste("nTA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=n35TA))+
    
    geom_point(data=FLK.data, aes (x=Month, y=n35TA, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)+
   geom_abline(slope = 0, intercept = mean_Op$OnTA, color="grey")
nTA_month
```

## DIC

```{r, echo=FALSE, fig.height=8, fig.width=8}
DIC_month<- Month_ploth+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste("DIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=DIC_umol_kg))+
    
    geom_point(data=FLK.data, aes (x=Month, y=DIC_umol_kg, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)+
   geom_abline(slope = 0, intercept = mean_Op$ODIC, color="grey")
DIC_month
```

## nDIC

```{r, echo=FALSE, fig.height=8, fig.width=8}
nDIC_month<- Month_ploth+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste("nDIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=n35DIC))+
    
    geom_point(data=FLK.data, aes (x=Month, y=n35DIC, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)+
   geom_abline(slope = 0, intercept = mean_Op$OnDIC, color="grey")
nDIC_month
```

## pCO2

```{r, echo=FALSE, fig.height=8, fig.width=8}
pCO2_month<- Month_ploth+
  scale_y_continuous(#limits = c(1,5.5),
                       name=expression(paste(pCO[2], " (", mu, " atm)")),
                       breaks = seq(200, 600, 100),
                       expand = c(0.05, 0.05)
                        ) +
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=pCO2_uatm))+
    
    geom_point(data=FLK.data, aes (x=Month, y=pCO2_uatm, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)+
   geom_abline(slope = 0, intercept = mean_Op$OpCO2, color="grey")
pCO2_month
```

## pH

```{r, echo=FALSE, fig.height=8, fig.width=8}
pH_month<- Month_ploth+
    scale_y_continuous(#limits = c(1,5.5),
                       name=(expression ("pH")),
                       breaks = seq(0, 9, 0.1),
                       expand = c(0.05, 0.05)
                        ) +
  
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=pH_calculated))+
    
    geom_point(data=FLK.data, aes (x=Month, y=pH_calculated, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)+
   geom_abline(slope = 0, intercept = mean_Op$OpH, color="grey")
pH_month
```

## Omega

```{r, echo=FALSE, fig.height=8, fig.width=8}
Omega_month<- Month_ploth+
   scale_y_continuous(#limits = c(1,5.5),
                       name=(expression ("Aragonite saturation state "~Omega)),
                       breaks = seq(1, 5, 1),
                       expand = c(0.05, 0.05)
                        ) +
  
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Month, y=Aragonite_Sat_W))+
    geom_point(data=FLK.data, aes (x=Month, y=Aragonite_Sat_W, 
                fill=Precipitation, shape=Extreme), 
                alpha=0.8, size=1)+
   geom_abline(slope = 0, intercept = mean_Op$OAra, color="grey")
Omega_month
```

## Stats by month

```{r}
  Month_Stats<- ddply (FLK.data_filtered, .(Zone, Sub_region, Month),
                            summarise,
                       
                  Tem_mean = mean (Temperature_C, na.rm = T),
                  Tem_sd = sd (Temperature_C, na.rm = T),
                  
                  Sal_mean = mean (BestSalinity, na.rm = T),
                  Sal_sd = sd (BestSalinity, na.rm = T),
                       
                  TA_mean = mean (TA_umol_kg, na.rm = T),
                  TA_sd = sd (TA_umol_kg, na.rm = T),
                  
                  nTA_mean = mean (n35TA, na.rm = T),
                  nTA_sd = sd (n35TA, na.rm = T),
                  
                  nDIC_mean = mean (n35DIC, na.rm = T),
                  nDIC_sd = sd (n35DIC, na.rm = T),
                  
                  DIC_mean = mean (DIC_umol_kg, na.rm = T),
                  DIC_sd = mean (DIC_umol_kg, na.rm = T),
                  
                  pCO2_mean = mean (pCO2_uatm , na.rm = T),
                  pCO2_sd = sd (pCO2_uatm , na.rm = T),
                  
                  pH_mean = mean (pH_calculated, na.rm = T),
                  pH_sd = mean (pH_calculated, na.rm = T),
                  
                  Ara_mean = mean (Aragonite_Sat_W , na.rm = T),
                  Ara_sd = mean (Aragonite_Sat_W , na.rm = T)
                  )
Month_Stats
```

# 5. Seasonal plots 

```{r}
Season_plot<- ggplot(FLK.data) +
        MyTheme +  
        facet_grid(Zone~Season)+
        scale_shape_manual(values=c(24, 25, 21))+
        theme(axis.title.x = element_blank())
```


## Temperature

```{r, echo=FALSE, fig.height=8, fig.width=4}
Temperature_season<- Season_plot+
    geom_abline(slope = 0, intercept = mean_Op$OTem, color="grey")+
    scale_y_continuous(#limits = c(15,40),
                       name=(expression("Temperature"~(degree*C))),
                       breaks = seq(16, 40, 4),  
                       expand = c(0.05, 0.05)) +
 
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region , y=Temperature_C))+
    
    geom_point(data=FLK.data, aes (x=Sub_region, y=Temperature_C, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.5, size=0.8)
Temperature_season
```

## Salinity

```{r, echo=FALSE, fig.height=8, fig.width=4}
Sal_season<- Season_plot+
    scale_y_continuous(#limits = c(15,40),
                       name=(expression("Salinity")),
                       breaks = seq(15, 40, 2),  
                       expand = c(0.05, 0.05)) +
    geom_abline(slope = 0, intercept = mean_Op$OSal, color="grey")+
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=BestSalinity))+
    
    geom_point(data=FLK.data, aes (x=Sub_region, y=BestSalinity, 
                                 fill=Precipitation, shape=Extreme), 
            alpha=0.5, size=0.8)
Sal_season
```

## TA

```{r, echo=FALSE, fig.height=8, fig.width=4}
TA_season<- Season_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste("TA (", mu, "mol ", kg^-1, ")")))+
    geom_abline(slope = 0, intercept = mean_Op$OTA, color="grey")+
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=TA_umol_kg))+
    
    geom_point(data=FLK.data, aes (x=Sub_region, y=TA_umol_kg, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.5, size=0.8)
TA_season
```

## n35TA

```{r, echo=FALSE, fig.height=8, fig.width=4}
nTA_season<- Season_plot+
 
   scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste("nTA (", mu, "mol ", kg^-1, ")")))+
    geom_abline(slope = 0, intercept = mean_Op$OnTA, color="grey")+
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=n35TA))+
    
    geom_point(data=FLK.data, aes (x=Sub_region, y=n35TA, 
                    fill=Precipitation, shape=Extreme), 
             alpha=0.5, size=0.8)
nTA_season
```

## DIC

```{r, echo=FALSE, fig.height=8, fig.width=4}
DIC_season<- Season_plot+
    scale_y_continuous(#limits = c(1700,2900),
                    expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste("DIC (", mu, "mol ", kg^-1, ")")))+
    geom_abline(slope = 0, intercept = mean_Op$ODIC, color="grey")+
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=DIC_umol_kg))+
    
    geom_point(data=FLK.data, aes (x=Sub_region, y=DIC_umol_kg, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.5, size=0.8)

DIC_season
```

## nDIC

```{r, echo=FALSE, fig.height=8, fig.width=4}
nDIC_season<- Season_plot+
 
   scale_y_continuous(#limits = c(1700,2900),
                      expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste("nDIC (", mu, "mol ", kg^-1, ")")))+
    geom_abline(slope = 0, intercept = mean_Op$OnDIC, color="grey")+
  
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=n35DIC))+
    
    geom_point(data=FLK.data, aes (x=Sub_region, y=n35DIC, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.5, size=0.8)
nDIC_season
```

## pCO2

```{r, echo=FALSE, fig.height=8, fig.width=4}
pCO2_season<- Season_plot+
   scale_y_continuous(#limits = c(1,5.5),
                       name=expression(paste(pCO[2], "(", mu, " atm)")),
                       breaks = seq(200, 700, 100),
                        expand = c(0.05, 0.05)
                        ) +
    geom_abline(slope = 0, intercept = mean_Op$OpCO2, color="grey")+
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=pCO2_uatm))+
    geom_point(data=FLK.data, aes (x=Sub_region, y=pCO2_uatm, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.5, size=0.8)
pCO2_season
```

## pH

```{r, echo=FALSE, fig.height=8, fig.width=4}
pH_season<- Season_plot+
    scale_y_continuous(#limits = c(1,5.5),
                       name=(expression ("pH")),
                       breaks = seq(0, 9, 0.1),
                       expand = c(0.05, 0.05)
                        ) +
    geom_abline(slope = 0, intercept = mean_Op$OpH, color="grey")+
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=pH_calculated))+
    
    geom_point(data=FLK.data, aes (x=Sub_region, y=pH_calculated, 
                                 fill=Precipitation, shape=Extreme), 
            alpha=0.5, size=0.8)
pH_season
```

## Omega

```{r, echo=FALSE, fig.height=8, fig.width=4}
Omega_season<- Season_plot+
   scale_y_continuous(#limits = c(1,5.5),
                       name=(expression ("Aragonite saturation state "~Omega)),
                       breaks = seq(1, 5, 1),
                       expand = c(0.05, 0.05)
                        ) +
    geom_abline(slope = 0, intercept = mean_Op$OAra, color="grey")+
    geom_boxplot(data=FLK.data[FLK.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=Aragonite_Sat_W))+
    geom_point(data=FLK.data, aes (x=Sub_region, y=Aragonite_Sat_W, 
                fill=Precipitation, shape=Extreme), 
                alpha=0.5, size=0.8)
Omega_season
```

## Stats by season

```{r}
  Seasonal_Stats<- ddply (FLK.data_filtered, .(Zone, Sub_region, Season),
                            summarise,
                          
                  Tem_mean = mean (Temperature_C, na.rm = T),
                  Tem_sd = sd (Temperature_C, na.rm = T),
                  
                  Sal_mean = mean (BestSalinity, na.rm = T),
                  Sal_sd = sd (BestSalinity, na.rm = T),
                  
                  TA_mean = mean (TA_umol_kg, na.rm = T),
                  TA_sd = sd (TA_umol_kg, na.rm = T),
                  
                  nTA_mean = mean (n35TA, na.rm = T),
                  nTA_sd = sd (n35TA, na.rm = T),
                  
                  nDIC_mean = mean (n35DIC, na.rm = T),
                  nDIC_sd = sd (n35DIC, na.rm = T),
                  
                  DIC_mean = mean (DIC_umol_kg, na.rm = T),
                  DIC_sd = mean (DIC_umol_kg, na.rm = T),
                  
                  pCO2_mean = mean (pCO2_uatm , na.rm = T),
                  pCO2_sd = sd (pCO2_uatm , na.rm = T),
                  
                  pH_mean = mean (pH_calculated, na.rm = T),
                  pH_sd = mean (pH_calculated, na.rm = T),
                  
                  Ara_mean = mean (Aragonite_Sat_W , na.rm = T),
                  Ara_sd = mean (Aragonite_Sat_W , na.rm = T)
                  )
Seasonal_Stats
```

# 6. Delta month plots 

```{r}
# 1. Get the oceanic / offshore mean values per month-year 

  WS.reef<-join(WS.reef, mean_Open, 
                 type = "left", by=c("MY", "Month"))

# 2. and subtract them from the reef data
  # Delta TA
  WS.reef$dTA_MY<-WS.reef$TA_umol_kg-WS.reef$OTA_my
  # Delta DIC
  WS.reef$dDIC_MY<-WS.reef$DIC_umol_kg-WS.reef$ODIC_my
  # Delta nTA
  WS.reef$dnTA_MY<-WS.reef$n35TA-WS.reef$OnTA_my
  # Delta nDIC
  WS.reef$dnDIC_MY<-WS.reef$n35DIC-WS.reef$OnDIC_my
  # Delta pCO2
  WS.reef$dpCO2_MY<-WS.reef$pCO2_uatm-WS.reef$OpCO2_O
  # Delta pH
  WS.reef$dpH_MY<-WS.reef$pH_calculated-WS.reef$OpH_O
   # Delta Omega
  WS.reef$dOme_MY<-WS.reef$Aragonite_Sat_W-WS.reef$OAra_O
  
  head(WS.reef)
  summary(WS.reef)
```

```{r}
Delta_plot<- ggplot(WS.reef) +
        MyTheme +  
        facet_grid(Zone~Sub_region)+
        scale_shape_manual(values=c(24, 25, 21))+
        geom_hline(yintercept = 0, color="gray")+
        theme(axis.title.x = element_blank())
        
```

## dTA

```{r, echo=FALSE, fig.height=8, fig.width=8}
TA_delta_m<- Delta_plot+
 
   scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     breaks = seq(-800, 800, 100),
                     name=expression(paste(Delta, "TA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Month, y=dTA_MY))+
    
    geom_point(data=WS.reef, aes (x=Month, y=dTA_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
TA_delta_m
```

## dnTA

```{r, echo=FALSE, fig.height=8, fig.width=8}
nTA_delta_m<- Delta_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     breaks = seq(-800, 800, 100),
                     name=expression(paste(Delta, " nTA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Month, y=dnTA_MY))+
    
    geom_point(data=WS.reef, aes (x=Month, y=dnTA_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
nTA_delta_m
```

## dDIC

```{r, echo=FALSE, fig.height=8, fig.width=8}
DIC_delta_m<- Delta_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     breaks = seq(-800, 800, 100),
                     name=expression(paste(Delta, "DIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Month, y=dDIC_MY))+
    
    geom_point(data=WS.reef, aes (x=Month, y=dDIC_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
DIC_delta_m
```

## dnDIC

```{r, echo=FALSE, fig.height=8, fig.width=8}
nDIC_delta_m<- Delta_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     breaks = seq(-800, 800, 100),
                     name=expression(paste(Delta, " nDIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Month, y=dnDIC_MY))+
    
    geom_point(data=WS.reef, aes (x=Month, y=dnDIC_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
nDIC_delta_m
```

## dpCO2

```{r, echo=FALSE, fig.height=8, fig.width=8}
pCO2_delta_m<- Delta_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     #breaks = seq(1800, 2800, 100),
                     name=expression(paste(Delta , pCO[2] , "(", mu, "atm) ")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Month, y=dpCO2_MY))+
    
    geom_point(data=WS.reef, aes (x=Month, y=dpCO2_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
pCO2_delta_m
```

## dpH

```{r, echo=FALSE, fig.height=8, fig.width=8}
pH_delta_m<- Delta_plot+
    scale_y_continuous(#limits = c(1,5.5),
                       name=(expression (paste(Delta, " pH"))),
                       breaks = seq(-5, 5, 0.1),
                       expand = c(0.05, 0.05)
                        ) +
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Month, y=dpH_MY))+
    
    geom_point(data=WS.reef, aes (x=Month, y=dpH_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
pH_delta_m
```

## dOmega

```{r, echo=FALSE, fig.height=8, fig.width=8}
Omega_delta_m<- Delta_plot+
   scale_y_continuous(#limits = c(1,5.5),
                       name=(expression (paste(Delta, " Aragonite saturation state "
                                               ~Omega))),
                       breaks = seq(-3, 3, 0.5),
                       expand = c(0.05, 0.05)
                        ) +
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Month, y=dOme_MY))+
    geom_point(data=WS.reef, aes (x=Month, y=dOme_MY, 
                fill=Precipitation, shape=Extreme), 
                alpha=0.8, size=1)
Omega_delta_m
```

## Delta month stats 

```{r}
  dMonth_Stats<- ddply (WS.reef, .(Zone, Sub_region, Month),
                            summarise,
                  dTA_mean = mean (dTA_MY, na.rm = T),
                  dTA_sd = sd (dTA_MY, na.rm = T),
                  
                  dnTA_mean = mean (dnTA_MY, na.rm = T),
                  dnTA_sd = sd (dnTA_MY, na.rm = T),
                 
                  dDIC_mean = mean (dDIC_MY, na.rm = T),
                  dDIC_sd = mean (dDIC_MY, na.rm = T),
                  
                  dnDIC_mean = mean (dnDIC_MY, na.rm = T),
                  dnDIC_sd = sd (dnDIC_MY, na.rm = T),
                  
                  dpCO2_mean = mean (dpCO2_MY , na.rm = T),
                  dpCO2_sd = sd (dpCO2_MY , na.rm = T),
                  
                  dpH_mean = mean (dpH_MY, na.rm = T),
                  dpH_sd = mean (dpH_MY, na.rm = T),
                  
                  dAra_mean = mean (dOme_MY , na.rm = T),
                  dAra_sd = mean (dOme_MY , na.rm = T)
                  )
dMonth_Stats
```

# 7. Delta Seasonal plots 

```{r}
Delta_S_plot<- ggplot(WS.reef) +
        MyTheme +  
        facet_grid(Zone~Season)+
        scale_shape_manual(values=c(24, 25, 21))+
        geom_hline(yintercept = 0, color="gray")+
        theme(axis.title.x = element_blank())
        
```

## TA

```{r, echo=FALSE, fig.height=8, fig.width=8}
TA_delta_S<- Delta_S_plot+
 
   scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, "TA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dTA_MY))+
    
    geom_point(data=WS.reef, aes (x=Sub_region, y=dTA_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
TA_delta_S
```

## nTA

```{r, echo=FALSE, fig.height=8, fig.width=8}
nTA_delta_S<- Delta_S_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, " nTA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dnTA_MY))+
    
    geom_point(data=WS.reef, aes (x=Sub_region, y=dnTA_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
nTA_delta_S
```

## DIC

```{r, echo=FALSE, fig.height=8, fig.width=8}
DIC_delta_S<- Delta_S_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, "DIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dDIC_MY))+
    
    geom_point(data=WS.reef, aes (x=Sub_region, y=dDIC_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
DIC_delta_S
```

## nDIC

```{r, echo=FALSE, fig.height=8, fig.width=8}
nDIC_delta_S<- Delta_S_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, " nDIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dnDIC_MY))+
    
    geom_point(data=WS.reef, aes (x=Sub_region, y=dnDIC_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
nDIC_delta_S
```

## pCO2

```{r, echo=FALSE, fig.height=8, fig.width=8}
pCO2_delta_S<- Delta_S_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.05, 0.05),
                    breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta , pCO[2] , "(", mu, "atm) ")))+
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dpCO2_MY))+
    
    geom_point(data=WS.reef, aes (x=Sub_region, y=dpCO2_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
pCO2_delta_S
```

## pH

```{r, echo=FALSE, fig.height=8, fig.width=8}
pH_delta_S<- Delta_S_plot+
    scale_y_continuous(#limits = c(1,5.5),
                       name=(expression (paste(Delta, " pH"))),
                       breaks = seq(-5, 5, 0.1),
                       expand = c(0.05, 0.05)
                        ) +
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dpH_MY))+
    
    geom_point(data=WS.reef, aes (x=Sub_region, y=dpH_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=1)
pH_delta_S
```

## Omega

```{r, echo=FALSE, fig.height=8, fig.width=8}
Omega_delta_S<- Delta_S_plot+
   scale_y_continuous(#limits = c(1,5.5),
                       name=(expression (paste(Delta, " Aragonite saturation state "
                                               ~Omega))),
                       breaks = seq(-3, 3, 0.5),
                       expand = c(0.05, 0.05)
                        ) +
  
    geom_boxplot(data=WS.reef[WS.reef$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dOme_MY))+
    geom_point(data=WS.reef, aes (x=Sub_region, y=dOme_MY, 
                fill=Precipitation, shape=Extreme), 
                alpha=0.8, size=1)
Omega_delta_S
```

# 8 Month in the reef_figures 

```{r}

Inshore.data<-WS.reef[WS.reef$Zone=="Inshore", ]

Final_plot<- ggplot(Inshore.data)+ 
        MyTheme +  theme(axis.title.x = element_blank())+
        facet_grid(~Sub_region)+
        scale_shape_manual(values=c(24, 25, 21))
```

## Temperature

```{r, echo=FALSE, fig.height=4, fig.width=8}
Temperature_fig<- Final_plot+
    scale_y_continuous(#limits = c(15,40),
                       name=(expression("Temperature"~(degree*C))),
                       breaks = seq(16, 40, 4),  
                       expand = c(0.05, 0.05)) +
 
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=Temperature_C))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=Temperature_C, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=0.8, show.legend = F)+
    geom_abline(slope = 0, intercept = mean_Op$OTem, color="grey")
Temperature_fig
```

## Salinity

```{r, echo=FALSE, fig.height=4, fig.width=8}
Sal_fig<- Final_plot+
       scale_y_continuous(#limits = c(15,40),
                       name=(expression("Salinity")),
                       breaks = seq(15, 40, 2),  
                       expand = c(0.05, 0.05)) +
 
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=BestSalinity))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=BestSalinity, 
                                 fill=Precipitation, shape=Extreme), 
               show.legend = F, alpha=0.8, size=0.8)+
    geom_abline(slope = 0, intercept = mean_Op$OSal, color="grey")
Sal_fig
```

## Delta TA

```{r, echo=FALSE, fig.height=4, fig.width=8}
DeltaTA_fig<- Final_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.02, 0.02),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, " TA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=dTA_MY))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=dTA_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=0.8, show.legend = F)+
    geom_abline(slope = 0, intercept = 0, color="grey")
DeltaTA_fig
```

## Delta nTA

```{r, echo=FALSE, fig.height=4, fig.width=8}
DeltanTA_fig<- Final_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.02, 0.02),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, " nTA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=dnTA_MY))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=dnTA_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=0.8, show.legend = F)+
    geom_abline(slope = 0, intercept = 0, color="grey")
DeltanTA_fig
```

## Delta DIC

```{r, echo=FALSE, fig.height=4, fig.width=8}
DeltaDIC_fig<- Final_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.02, 0.02),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, " DIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=dDIC_MY))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=dDIC_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=0.8, show.legend = F)+
    geom_abline(slope = 0, intercept = 0, color="grey")
DeltaDIC_fig
```

## nDelta DIC

```{r, echo=FALSE, fig.height=4, fig.width=8}
DeltanDIC_fig<- Final_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.02, 0.02),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, " nDIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=dnDIC_MY))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=dnDIC_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=0.8, show.legend = F)+
    geom_abline(slope = 0, intercept = 0, color="grey")
DeltanDIC_fig
```

## pCO2

```{r, echo=FALSE, fig.height=4, fig.width=8}
pCO2_fig<- Final_plot+
       scale_y_continuous(#limits = c(1,5.5),
                       name=expression(paste(pCO[2], "(", mu, " atm)")),
                       breaks = seq(200, 700, 100),
                        expand = c(0.05, 0.05)
                        ) +
 
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=pCO2_uatm))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=pCO2_uatm, 
                                 fill=Precipitation, shape=Extreme), 
               show.legend = F, alpha=0.8, size=0.8)+
    geom_abline(slope = 0, intercept = mean_Op$OpCO2, color="grey")
pCO2_fig
```

## pH

```{r, echo=FALSE, fig.height=4, fig.width=8}
pH_fig<- Final_plot+
    scale_y_continuous(#limits = c(1,5.5),
                       name=(expression ("pH")),
                       breaks = seq(0, 9, 0.1),
                       expand = c(0.05, 0.05)
                        ) +
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=pH_calculated))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=pH_calculated, 
                                 fill=Precipitation, shape=Extreme), 
               show.legend = F, alpha=0.8, size=0.8)+
    geom_abline(slope = 0, intercept = mean_Op$OpH, color="grey")
pH_fig
```

## Omega

```{r, echo=FALSE, fig.height=4, fig.width=8}
Omega_fig<- Final_plot+
          scale_y_continuous(#limits = c(1,5.5),
                       name=(expression ("Aragonite "~Omega)),
                       breaks = seq(1, 5, 0.5),
                       expand = c(0.05, 0.05)
                        ) +
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Month, y=Aragonite_Sat_W))+
    
    geom_point(data=Inshore.data, aes (x=Month, y=Aragonite_Sat_W, 
                                 fill=Precipitation, shape=Extreme), 
               show.legend = F, alpha=0.8, size=0.8)+
    geom_abline(slope = 0, intercept = mean_Op$OAra, color="grey")
Omega_fig
```

```{r}
Figure_monts<-ggarrange(DeltaTA_fig, DeltaDIC_fig,
                        DeltanTA_fig, DeltanDIC_fig,
                        pCO2_fig, pH_fig, 
                        Temperature_fig, Sal_fig, Omega_fig,
                        
          #labels = c("", ""),
          ncol = 2, nrow = 5)
#Figure_monts

Figure_monts2<-ggarrange(DeltaTA_fig, DeltanTA_fig,
                        DeltaDIC_fig, DeltanDIC_fig,
                        #pCO2_fig, pH_fig, 
                        #Temperature_fig, Sal_fig, Omega_fig,
                        
          #labels = c("", ""),
          ncol = 1)
Figure_monts2
```

## Delta month stats 

```{r}
  dSeason_Stats<- ddply (WS.reef, .(Zone, Sub_region, Season),
                            summarise,
                  dTA_mean = mean (dTA_MY, na.rm = T),
                  dTA_sd = sd (dTA_MY, na.rm = T),
                  
                  dnTA_mean = mean (dnTA_MY, na.rm = T),
                  dnTA_sd = sd (dnTA_MY, na.rm = T),
                 
                  dDIC_mean = mean (dDIC_MY, na.rm = T),
                  dDIC_sd = mean (dDIC_MY, na.rm = T),
                  
                  dnDIC_mean = mean (dnDIC_MY, na.rm = T),
                  dnDIC_sd = sd (dnDIC_MY, na.rm = T),
                  
                  dpCO2_mean = mean (dpCO2_MY , na.rm = T),
                  dpCO2_sd = sd (dpCO2_MY , na.rm = T),
                  
                  dpH_mean = mean (dpH_MY, na.rm = T),
                  dpH_sd = mean (dpH_MY, na.rm = T),
                  
                  dAra_mean = mean (dOme_MY , na.rm = T),
                  dAra_sd = mean (dOme_MY , na.rm = T)
                  )
dSeason_Stats
```

# 9 Season in the reef_figures 

```{r}
Season_plot<- ggplot(Inshore.data)+ 
        MyTheme +  theme(axis.title.x = element_blank())+
        facet_grid(~Season)+
        scale_shape_manual(values=c(24, 25, 21))
```

## Temperature

```{r, echo=FALSE, fig.height=4, fig.width=8}
Temperature_sea<- Season_plot+
    scale_y_continuous(#limits = c(15,40),
                       name=(expression("Temperature"~(degree*C))),
                       breaks = seq(16, 40, 4),  
                       expand = c(0.05, 0.05)) +
 
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=Temperature_C))+
    
    geom_jitter(data=Inshore.data, aes (x=Sub_region, y=Temperature_C, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=0.8, show.legend = F, width = 0.20)+
    geom_abline(slope = 0, intercept = mean_Op$OTem, color="grey")
Temperature_sea
```

## Salinity

```{r, echo=FALSE, fig.height=4, fig.width=8}
Sal_sea<- Season_plot+
       scale_y_continuous(#limits = c(15,40),
                       name=(expression("Salinity")),
                       breaks = seq(15, 40, 2),  
                       expand = c(0.05, 0.05)) +
 
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=BestSalinity))+
    
    geom_jitter(data=Inshore.data, aes (x=Sub_region, y=BestSalinity, 
                                 fill=Precipitation, shape=Extreme), 
               alpha=0.8, size=0.8, show.legend = F, width = 0.20)+
    geom_abline(slope = 0, intercept = mean_Op$OSal, color="grey")
Sal_sea
```

## Delata TA

```{r, echo=FALSE, fig.height=4, fig.width=8}
DeltaTA_sea<- Season_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.02, 0.02),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, " TA (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dTA_MY))+
    
    geom_point(data=Inshore.data, aes (x=Sub_region, y=dTA_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=0.8, show.legend = F)+
    geom_abline(slope = 0, intercept = 0, color="grey")
DeltaTA_sea
```

## Delta DIC

```{r, echo=FALSE, fig.height=4, fig.width=8}
DeltaDIC_sea<- Season_plot+
    scale_y_continuous(#limits = c(1700,2900),
                     expand = c(0.02, 0.02),
                     breaks = seq(-500, 500, 100),
                     name=expression(paste(Delta, " DIC (", mu, "mol ", kg^-1, ")")))+
  
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=dTA_MY))+
    
    geom_point(data=Inshore.data, aes (x=Sub_region, y=dDIC_MY, 
                                 fill=Precipitation, shape=Extreme), 
             alpha=0.8, size=0.8, show.legend = F)+
    geom_abline(slope = 0, intercept = 0, color="grey")
DeltaDIC_sea
```

## pCO2

```{r, echo=FALSE, fig.height=4, fig.width=8}
pCO2_sea<- Season_plot+
       scale_y_continuous(#limits = c(1,5.5),
                       name=expression(paste(pCO[2], "(", mu, " atm)")),
                       breaks = seq(200, 700, 100),
                        expand = c(0.05, 0.05)
                        ) +
 
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=pCO2_uatm))+
    
    geom_point(data=Inshore.data, aes (x=Sub_region, y=pCO2_uatm, 
                                 fill=Precipitation, shape=Extreme), 
               show.legend = F, alpha=0.8, size=0.8)+
    geom_abline(slope = 0, intercept = mean_Op$OpCO2, color="grey")
pCO2_sea
```

## pH

```{r, echo=FALSE, fig.height=4, fig.width=8}
pH_sea<- Season_plot+
    scale_y_continuous(#limits = c(1,5.5),
                       name=(expression ("pH")),
                       breaks = seq(0, 9, 0.1),
                       expand = c(0.05, 0.05)
                        ) +
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=pH_calculated))+
    
    geom_point(data=Inshore.data, aes (x=Sub_region, y=pH_calculated, 
                                 fill=Precipitation, shape=Extreme), 
               show.legend = F, alpha=0.8, size=0.8)+
    geom_abline(slope = 0, intercept = mean_Op$OpH, color="grey")
pH_sea
```

## Omega

```{r, echo=FALSE, fig.height=4, fig.width=8}
Omega_sea<- Season_plot+
          scale_y_continuous(#limits = c(1,5.5),
                       name=(expression ("Aragonite "~Omega)),
                       breaks = seq(1, 5, 0.5),
                       expand = c(0.05, 0.05)
                        ) +
    geom_boxplot(data=Inshore.data[Inshore.data$Extreme=="Normal", ], 
                 aes (x=Sub_region, y=Aragonite_Sat_W))+
    
    geom_point(data=Inshore.data, aes (x=Sub_region, y=Aragonite_Sat_W, 
                                 fill=Precipitation, shape=Extreme), 
               show.legend = F, alpha=0.8, size=0.8)+
    geom_abline(slope = 0, intercept = mean_Op$OAra, color="grey")
Omega_sea
```

```{r}
Figure_sea<-ggarrange(DeltaTA_sea, DeltaDIC_sea, pCO2_sea, pH_sea, 
                        Temperature_sea, Sal_sea, Omega_sea,
                        
          #labels = c("", ""),
          ncol = 2, nrow = 4)
Figure_sea
```

