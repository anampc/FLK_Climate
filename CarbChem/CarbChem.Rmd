---
title: "Carbon Chemestry explore"
author: "Ana Palacio-Castro"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_height: 5
    fig_width: 7
    df_print: paged
    toc: yes
editor_options:
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Libraries and settings

```{r, include=FALSE}
# Libraries
    library(plyr)
    library(tidyverse)
    library(reshape2)
    library(ggthemes)
    library(lubridate)
    library(knitr)

# Interactive Maps
library(leaflet)
```

# Import and format carbon chemestry data

```{r, include=FALSE}
# 1. Get data
CC.data<-read.csv("Data/NCRMP_CarbonateChemistryData_All_Atlantic_updated.csv", header = T)
  summary(CC.data)
  str((CC.data))
  #summary(CC.data$Region)
  #summary(CC.data$Location)
  Sites<-as.data.frame(unique(CC.data$SiteID))

# 2. Format variables
  # Date/times
  CC.data$Year<-as.numeric(CC.data$Year)
  CC.data$Date<-as.Date(CC.data$ESTDate, "%m/%d/%Y")
 
  # Numerical data
  CC.data$Latitude <- gsub("N/A", "NA", CC.data$Latitude)
  CC.data$Latitude <-as.numeric((as.character(CC.data$Latitude)))
  CC.data$Longitude <-as.numeric((as.character(CC.data$Longitude)))
  
  CC.data$Temperature_C <-
    as.numeric((as.character(CC.data$Temperature_C)))
  
  CC.data$TA <-as.numeric((as.character(CC.data$TA)))
  CC.data$DIC <-as.numeric((as.character(CC.data$DIC)))
  CC.data$pH <-as.numeric((as.character(CC.data$pH)))
  CC.data$pCO2 <-as.numeric((as.character(CC.data$pCO2)))
  CC.data$Aragonite_Sat_W<-
    as.numeric((as.character(CC.data$Aragonite_Sat_W)))
```

Notes:
* Regions are: DRTO, FGB, FLK, PR, SEFCRI, STX, USVI 
* Locations are: DRTO  FGB   FL  FLK   PR  STJ  STT  STX
* How can I get lower, middle and upper keys?
* Site IDs are still showing duplicates (i.e., lowercase vs capital letters, spaces, etc)
* Replace all N/As by NAs. It gives scary warnings of NAs introduced by coercion. What else is wrong?

# Add seasonality

```{r, include=FALSE}
# Define seasons
  metseasons <- c(
    "01" = "Winter", "02" = "Winter",
    "03" = "Spring", "04" = "Spring", "05" = "Spring",
    "06" = "Summer", "07" = "Summer", "08" = "Summer",
    "09" = "Fall", "10" = "Fall", "11" = "Fall",
    "12" = "Winter"
  )

Seasons<-as.data.frame(metseasons[format(CC.data$Date, "%m")])
colnames(Seasons)<-"Season"
CC.data<-cbind(CC.data, Seasons)

```


# 1. Data available

## Locations

```{r MapINformation, include=FALSE}
# Map information
# Add info from the sampling stations
Locations <- CC.data %>% select(Latitude,
                                Longitude, 
                                Location, 
                                Sample_Depth_m)
Locations$GPS<-paste(Locations$Latitude,
                     "-", 
                     Locations$Longitude)

Locations<-unique(Locations)

#Change color depending on type of data?
  #stations$Site<-as.numeric(stations$Site)
  # pal <- colorNumeric(palette = "YlOrRd", 
                      #domain = stations$Site)
  
  #stations$Site<-as.factor(stations$Site)
  pal.gen <- colorFactor(palette = "Set1",
                         domain = Locations$Location)
```


```{r makeAmap, echo=FALSE}
leaflet(Locations, height = '400px') %>% 
  addTiles() %>%
  addProviderTiles(providers$Esri.WorldImagery)%>%
  #addProviderTiles(providers$CartoDB.Positron) %>% 
  #addMarkers(icon=coral.icon) %>% 
  addCircleMarkers(lng = ~Longitude, lat = ~Latitude, 
                   stroke = TRUE, radius = 4, 
                   fillOpacity = 1,
                   color = ~pal.gen(Location),
                   label = ~Sample_Depth_m,
                   labelOptions = labelOptions(
                     noHide = T, direction = "bottom",
                     textOnly = TRUE,
                     style = list(
        "color" = "white")))  %>%
  addLegend(position = "bottomright",
            pal = pal.gen, 
            values = ~Location, opacity = 1) %>%
  fitBounds(lng1=-83.01, lat=24.7, lng2=-82.76, lat2=24.6)
  
```

Map of the sites were samples are collected

**Notes:**
* Multiple dephts: FGB (3x),  DRTO (2x or 3x?), STT(2x), STX(2x)

## Number of samples

### By depht and location

```{r, echo=FALSE}
Cases_Loc_Depht<-CC.data %>% count(Location,
                                  Sample_Depth_m,
                                  sort = F)

Cases_Loc_Depht<-as.data.frame(Cases_Loc_Depht %>%
                   pivot_wider(names_from = Sample_Depth_m,
                   values_from = n))

kable(as.data.frame(Cases_Loc_Depht, format = "markdown"), longtable = TRUE)
```

**Notes:** 
* Is DRTO depth = NA equivalent to 0m?
* Can we pooled STX depht = 15.24 into 15?

### By year and region

```{r, echo=FALSE}
Cases_Reg_Year<-CC.data %>% count(Year, Region, sort = F)

Cases_Reg_Year<-as.data.frame(Cases_Reg_Year %>%
    pivot_wider(names_from = Year, values_from = n))

kable(as.data.frame(Cases_Reg_Year, format = "html"))
```

### By season and region

```{r, echo=FALSE}
Cases_Reg_season<-CC.data %>% count(Season, Region, sort = T)

Cases_Reg_season<-as.data.frame(Cases_Reg_season %>%
    pivot_wider(names_from = Season, values_from = n))

kable(as.data.frame(Cases_Reg_season, format = "html"))
```

### By mission, year, region

```{r, echo=FALSE}
Cases_Mission<-CC.data %>% count(Region,
                                 Mission,
                                 Year, sort = F)

Cases_Mission<-as.data.frame(Cases_Mission %>%
    pivot_wider(names_from = Year, values_from = n))

kable(as.data.frame(Cases_Mission, format = "html"), caption="Samples collected by each mission")
```

## Number of sites per region

Florida Keys 

```{r, echo=FALSE}
Cases_Site_FLK<-filter(CC.data, Region=="FLK") %>% count(Year, SiteID, sort = T)
Cases_Site_FLK

Cases_Site_FLK<-as.data.frame(Cases_Site_FLK %>%
    pivot_wider(names_from = Year, values_from = n))

kable(as.data.frame(Cases_Site_FLK, format = "html"))
```

**Note:** This looks like the original data were the SiteIDs are not curated :( 

Puerto Rico 

```{r, echo=FALSE}
Cases_Site_PR<-filter(CC.data, Region=="PR") %>% count(Year, SiteID, sort = F)
Cases_Site_PR

Cases_Site_PR<-Cases_Site_PR %>%
    pivot_wider(names_from = Year, values_from = n)

#kable(head(Cases_Site_PR, format = "html"))
```

**Note:** Each sample has an unique SiteID? 
* What do this IDs mean? 
* 2 SiteID have 5 digits instead 4... are these typos? Can we relate this numbers to coral cover? 


# 2. Basic stats summary

## Temperature

```{r, echo=FALSE}

Temp.Season <- ddply (CC.data, .(Region, Season),summarise,
                Tmin = min (Temperature_C, na.rm = F), 
                Tmax = max (Temperature_C, na.rm = F),
                Tmean = mean (Temperature_C, na.rm = F), 
                Tsd = sd (Temperature_C, na.rm = F))

kable(as.data.frame(Temp.Season, format = "markdown"))


```

## Aragonite

```{r}

Aragonite.Season <- ddply (CC.data, .(Region, Season),summarise,
                Amin = min (Aragonite_Sat_W, na.rm = F), 
                Amax = max (Aragonite_Sat_W, na.rm = F),
                Amean = mean (Aragonite_Sat_W, na.rm = F), 
                Asd = sd (Aragonite_Sat_W, na.rm = F))

kable(as.data.frame(Aragonite.Season, format = "markdown"))
```

## TA

```{r}
TA.Season <- ddply (CC.data, .(Region, Season),summarise,
                TAmin = min (TA, na.rm = F), 
                TAmax = max (TA, na.rm = F),
                TAmean = mean (TA, na.rm = F), 
                TAsd = sd (TA, na.rm = F))

kable(as.data.frame(TA.Season, format = "markdown"))
```


## DIC

```{r}
DIC.Season <- ddply (CC.data, .(Region, Season),summarise,
                Amin = min (DIC, na.rm = F), 
                Amax = max (DIC, na.rm = F),
                Amean = mean (DIC, na.rm = F), 
                Asd = sd (DIC, na.rm = F))

kable(as.data.frame(DIC.Season, format = "markdown"))
```

**Note:** What is limit for the seasons that makes more sense (now jus using months)?. Wet vs dry/ temperature/light 

# Explore plots

## Aragonite overview

### Sites

```{r, echo=FALSE, fig.heigh=11, fig.width=7}
Aragonite<- ggplot(CC.data) + theme_bw() +
  
  scale_y_continuous(limits = c(0,5.5),
                       name=("Aragonite Saturation") ,
                       breaks = seq(0, 5, 1),  
                       expand = c(0, 0)) +
  scale_x_date(name="Date",
               #labels = date_format("%M/%Y"),
               #limits = c(-1,114),
               expand = c(0, 0),
               breaks ="6 months")+
  
  #scale_shape_manual(values=c(21,2,24))+
  #scale_colour_manual(values = c("gray35","gray70", "gray70"))+

geom_point(aes (Date, Aragonite_Sat_W, fill=SiteID), shape=21)+    
#geom_point(aes (Date, Aragonite_Sat_W, fill=Sample_Depth_m), shape=21)+
#geom_line(aes (Date, Aragonite_Sat_W, fill=SiteID), alpha=0.3)+

theme(legend.position="none",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, color = "black")
          ) +
  geom_abline(slope = 0, intercept = 3, color="gray", linetype=2)+
  facet_grid(Region~.)
  
Aragonite
#ggsave(file="Outputs/Aragonite.svg", plot=Aragonite, dpi = 300, width=6, height=4)

```

What is the meaning of the sites?

### Seasons

```{r, echo=FALSE, fig.heigh=11, fig.width=7}
AragoniteS<- ggplot(CC.data) + theme_bw() +
  
  scale_y_continuous(limits = c(0,5.5),
                       name=("Aragonite Saturation") ,
                       breaks = seq(0, 5, 1),  
                       expand = c(0, 0)) +
  scale_x_date(name="Date",
               #labels = date_format("%M/%Y"),
               #limits = c(-1,114),
               expand = c(0, 0),
               breaks ="6 months")+
  
  #scale_shape_manual(values=c(21,2,24))+
  #scale_colour_manual(values = c("gray35","gray70", "gray70"))+

geom_point(aes (Date, Aragonite_Sat_W, fill=Season), shape=21)+    
#geom_point(aes (Date, Aragonite_Sat_W, fill=Sample_Depth_m), shape=21)+
#geom_line(aes (Date, Aragonite_Sat_W, fill=SiteID), alpha=0.3)+

theme(legend.position="top",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, color = "black")
          ) +
  geom_abline(slope = 0, intercept = 3, color="gray", linetype=2)+
  facet_grid(Region~.)
  
AragoniteS
#ggsave(file="Outputs/Aragonite.svg", plot=Aragonite, dpi = 300, width=6, height=4)

```

## Temperature overview

```{r, echo=FALSE}
Temperature_All<- ggplot(CC.data) + theme_bw() +
  
  scale_y_continuous(limits = c(15,40),
                       name=(expression("Temperature"~(degree*C))),
                       breaks = seq(16, 40, 2),  
                       expand = c(0, 0)) +
  scale_x_date(name="Date",
               #labels = date_format("%M/%Y"),
               #limits = c(-1,114),
               #expand = c(0, 0),
               breaks ="6 months")+
  
  #scale_shape_manual(values=c(21,2,24))+
  #scale_colour_manual(values = c("gray35","gray70", "gray70"))+
  
geom_point(aes (Date, Temperature_C, fill=Region), shape=21)+
#geom_line(aes (Date, Temperature_C, colour=SiteID))+
 
theme(legend.position="none",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, color = "black")
          ) 
Temperature_All
#ggsave(file="Outputs/Figure_1_Experiment_design.svg", plot=Design, dpi = 300, width=6, height=4)

```

**Note:** Are the 38+ data points real? 

```{r, echo=FALSE,  fig.heigh=8, fig.width=7}
Temperature_Reg_Season<- ggplot(CC.data) + theme_bw() +
  
  scale_y_continuous(limits = c(15,40),
                       name=(expression("Temperature"~(degree*C))),
                       breaks = seq(16, 40, 2.5),  
                       expand = c(0, 0)) +
  scale_x_date(name="Date",
               #labels = date_format("%M/%Y"),
               #limits = c(-1,114),
               #expand = c(0, 0),
               breaks ="6 months")+
  
geom_point(aes (Date, Temperature_C, fill=Season), shape=21)+
#geom_line(aes (Date, Temperature_C, colour=SiteID))+
 
theme(legend.position="top",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, color = "black")
          ) 
Temperature_Reg_Season
#ggsave(file="Outputs/Figure_1_Experiment_design.svg", plot=Design, dpi = 300, width=6, height=4)

Temperature_Reg_Season+facet_grid(Region~.)
```


## Salinity overview

```{r, echo=FALSE}
Sal_All<- ggplot(CC.data) + theme_bw() +
  
   # scale_y_continuous(#limits = c(15,40),
   #                      name="Salinity",
   #                     # breaks = seq(16, 40, 2),  
   #                      expand = c(0, 0)) +
  scale_x_date(name="Date",
               #labels = date_format("%M/%Y"),
               #limits = c(-1,114),
               #expand = c(0, 0),
               breaks ="6 months")+
  
 
geom_point(aes (Date, Salinity_Bottle, fill=Region), shape=21)+
#geom_line(aes (Date, Temperature_C, colour=SiteID))+
 
theme(legend.position="top",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, color = "black")
          ) 
Sal_All
#ggsave(file="Outputs/Figure_1_Experiment_design.svg", plot=Design, dpi = 300, width=6, height=4)

```

**Note:** Are the 38+ data points real? 

```{r, echo=FALSE,  fig.heigh=8, fig.width=7}
Sal_Reg_Season<- ggplot(CC.data) + theme_bw() +
  
  # scale_y_continuous(limits = c(15,40),
  #                      name=(expression("Temperature"~(degree*C))),
  #                      breaks = seq(16, 40, 2.5),  
  #                      expand = c(0, 0)) +
  scale_x_date(name="Date",
               #labels = date_format("%M/%Y"),
               #limits = c(-1,114),
               #expand = c(0, 0),
               breaks ="6 months")+
  
geom_point(aes (Date, Salinity_Bottle, fill=Season), shape=21)+
 
theme(legend.position="top",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, color = "black")
          ) 
Sal_Reg_Season
#ggsave(file="Outputs/Figure_1_Experiment_design.svg", plot=Design, dpi = 300, width=6, height=4)

#Sal_Reg_Season+facet_grid(Region~.)
```

## Correlations to check outliers

Temperature and Arg

```{r, echo=FALSE}
Relationships<- ggplot(CC.data) + theme_bw() +
  
  scale_y_continuous(limits = c(15,40),
                       name=(expression("Temperature"~(degree*C))),
                       breaks = seq(16, 40, 2),
                       expand = c(0, 0)) +
  scale_x_continuous(name="Aragonite",
                 limits = c(0.5,6),
                 expand = c(0, 0),
                 breaks = seq(1,6,1))+
  
geom_point(aes (Aragonite_Sat_W, Temperature_C, fill=Region), alpha=0.5, shape=21)+
#geom_line(aes (Date, Temperature_C, colour=SiteID))+
 
theme(legend.position="none",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, color = "black")
          ) +
  geom_abline(slope = 0, intercept = 29.5, color="gray", linetype=2)+
  geom_vline(xintercept = 3, color="gray", linetype=2)
Relationships
#ggsave(file="Outputs/Figure_1_Experiment_design.svg", plot=Design, dpi = 300, width=6, height=4)
```

TA and DIC

```{r, echo=FALSE}
Relationships2<- ggplot(CC.data) + theme_bw() +
  
  scale_y_continuous(limits = c(1700,2900),
                       name="TA",
                       breaks = seq(1800, 2800, 200),
                       expand = c(0, 0)) +
  # scale_x_continuous(name="Aragonite",
  #                limits = c(0.5,6),
  #                expand = c(0, 0),
  #                breaks = seq(1,6,1))+
  
geom_point(aes (DIC, TA, fill=Season), alpha=0.5, shape=21)+
#geom_line(aes (Date, Temperature_C, colour=SiteID))+
 
theme(legend.position="top",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA, color = "black")
          )
  #geom_abline(slope = 0, intercept = 29.5, color="gray", linetype=2)+
  #geom_vline(xintercept = 3, color="gray", linetype=2)
Relationships2
#ggsave(file="Outputs/Figure_1_Experiment_design.svg", plot=Design, dpi = 300, width=6, height=4)
```

```{r}
Relationships2 + scale_x_continuous(name="DIC",
                  limits = c(1550, 2500),
                  expand = c(0, 0),
                  breaks = seq(1600,2500,200))

Relationships2 + scale_x_continuous(name="DIC",
                  limits = c(1550, 2500),
                  expand = c(0, 0),
                  breaks = seq(1600,2500,200))+
  facet_wrap(~Region)
  
```

# 3. Notes/ideas

* Regional CC
* local carbonate chemistry: 
  * Seasonal (light), storms, upwelling, salinity (rain). 
  *Biological: coral/seagrass/macroalgae cover 
  * Biological + Seasonal: Photosyntesis, respiration.
  * Physical: inlets, rivers, upwelling

## Manzello (2012)

* local carbonate chemistry: Variation on CO2, alkalinity, and salinity - Florida Reef Tract (FRT) data.

* Meassure total CO2 (TCO2) - coulometrically and total alkalinity (TA) - gran titration. Other paramethers derived 
* Predominantly in inshore / upper FRT (higher than modeled). 
* H Productivity -> net uptake of total CO2 (TCO2) -> H aragonite
*Offshore reefs: oceanic carbonate chemistries consistent with present day tropical surface ocean conditions.
* Photosynthetic uptake of TCO2 by seagrasses/macroalgae in the inshore waters of the FRT. Acidification refugia (spatial * time)

## Uthicke (2014)

* GBR - 14 Inshore fringing  reefs
Meassured: TA and DIC. Derived:pCO2, pH and aragonite
* TA: 2069 - 2364 mmol kg2
* DIC:1846 - 2099 mmol kg2
* pCO2: 340 - 554 matm
  * Higher wet seasons
  * Inshore reefs above atmospheric values.
  * Arg was not further reduced in the wet season (temp effects)
  *Thermodynamic effects and anthropogenic runoff (P, R and P/R ratios).
  * Expected slope of  linear regression bw DIC and TA in systems where calcification is dominating is ~ 2.0 
  
## Cyronak (2018)

* Net community production; NCP - organic
* net community calcification; NCC inorganic
* 23 coral reef locations across the globe - derived from TA and DIC
* All reefs were net calcifying for the majority of observations (alkalinity depletion relative to offshore)
* Occasional observations of net dissolution occurred at most locations
* Influence of organic carbon fluxes on total changes in dissolved inorganic carbon (DIC) (i.e., NCP compared to the sum of NCP and NCC) =  32% to 88% -> biogeochemical differences between reefs. 
* Reefs with the largest relative percentage of NCP experienced the largest variability in seawater pH for a given change in DIC -> ability to elevate or suppress local pH relative to the open ocean.

## Ian (2019) 

* Reefs and inlets were sampled
* Reefs: Elevated pCO2 in warmer wet season
* Inlets: more dynamic -> periodic pulses of acidified water -> more acidification than reefs. 
  - Negative correlation bw salinity and both TA, and DIC. Elevated TA and DIC in low salinity waters ->  carbonate dissolution as a result of organic matter decomposition?.

# 4. Data analysis 

## Salinity standarizations 

* Total Alcalinity (TA)

```{r}
TA_Salinty<- ggplot(CC.data) + theme_bw() +
  
  scale_y_continuous(#limits = c(1700,2900),
                    name="Total alkalinity (TA)",
    #               breaks = seq(1800, 2800, 200),
                    expand = c(0.1, 0.1)) +
  scale_x_continuous(name="Salinity (PSU)",
  #                limits = c(0.5,6),
  #                breaks = seq(1,6,1),
                   expand = c(0.1, 0.1))+
  
geom_point(aes (Salinity_Bottle, TA, fill=Season), 
           alpha=0.5, shape=21)+
 
theme(legend.position="top",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA,
                                         color = "black"))
TA_Salinty+ facet_wrap(~Location, scales = "free")
#ggsave(file="Outputs/Figure_1_Experiment_design.svg", plot=Design, dpi = 300, width=6, height=4)
```

* Disolved inorganic Carbon (DIC)

```{r}
DIC_Salinty<- ggplot(CC.data) + theme_bw() +
  
  scale_y_continuous(#limits = c(1700,2900),
                  name="Disolved Inorganic Carbon (DIC)",
    #             breaks = seq(1800, 2800, 200),
                  expand = c(0.1, 0.1)) +
  scale_x_continuous(name="Salinity (PSU)",
  #                limits = c(0.5,6),
  #                breaks = seq(1,6,1),
                   expand = c(0.1, 0.1))+
geom_point(aes (Salinity_Bottle, DIC, fill=Season), 
           alpha=0.5, shape=21)+
 
theme(legend.position="top",
          plot.background=element_blank(),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.box.background = element_rect(),
          panel.background =element_rect(fill = NA,
                                         color = "black"))
DIC_Salinty + facet_wrap(~Location, scales = "free")
#ggsave(file="Outputs/Figure_1_Experiment_design.svg", plot=Design, dpi = 300, width=6, height=4)
```

